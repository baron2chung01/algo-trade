{% extends "base.html" %} {% block title %}VCP Scan{% endblock %} {% block page_id %}vcp-scan{% endblock %} {% block footer_scripts %}
<script src="/static/app.js" type="module" defer></script>
{% endblock %} {% block content %}
<div class="page-intro">
  <h1>VCP Scan</h1>
  <p class="page-intro__subtitle">
    Sweep a liquidity-filtered US equity universe for Volatility Contraction Pattern breakouts. Choose a preset timeframe and pick which rule sets to enforce during the scan.
  </p>
</div>
<section class="layout">
  <aside class="control-panel">
    <form id="scan-form" class="control-form">
      <div class="form-section">
        <h2 class="form-section-title">Universe</h2>
        <p>Defaults to the cached list of US stocks with recent monthly dollar volume above $1.5M. Provide comma-separated tickers to override.</p>
        <label>
          Custom symbols
          <textarea id="scan-symbols" name="symbols" rows="3" placeholder="e.g. AAPL, TSLA, NVDA"></textarea>
        </label>
      </div>

      <div class="form-section">
        <h2 class="form-section-title">Scan Preset</h2>
        <label>
          Timeframe
          <select id="scan-timeframe" name="timeframe">
            <option value="short">Short (45-day base)</option>
            <option value="medium" selected>Medium (60-day base)</option>
            <option value="long">Long (75-day base)</option>
          </select>
        </label>
        <label>
          Max candidates
          <input id="scan-max-candidates" name="max_candidates" type="number" min="0" step="1" value="50" />
        </label>
      </div>

      <div class="form-section">
        <h2 class="form-section-title">Criteria</h2>
        <p>Select which rule sets to enforce when filtering results.</p>
        <label class="checkbox">
          <input type="checkbox" id="criterion-flag-vcp" value="flag_vcp" data-scan-criterion checked />
          Flag/VCP
        </label>
        <label class="checkbox">
          <input type="checkbox" id="criterion-minervini" value="minervini" data-scan-criterion checked />
          Minervini Criteria
        </label>
        <label class="checkbox">
          <input type="checkbox" id="criterion-qullamagie" value="qullamagie" data-scan-criterion checked />
          Qullamagie Criteria
        </label>
      </div>

      <button id="scan-run-button" type="submit">Run Scan</button>
    </form>

    <div class="status" id="scan-status"></div>
  </aside>

  <section class="metrics" id="scan-results">
    <div class="metric-group">
      <div class="metric-group-header">
        <h3>Scan Summary</h3>
        <span id="scan-summary-timestamp" class="metric-window"></span>
      </div>
      <div class="metric-grid">
        <div class="metric-card">
          <span class="metric-label">Timeframe</span>
          <span class="metric-value" id="scan-summary-timeframe">–</span>
        </div>
        <div class="metric-card">
          <span class="metric-label">Criteria enforced</span>
          <span class="metric-value" id="scan-summary-params">–</span>
        </div>
        <div class="metric-card">
          <span class="metric-label">Symbols scanned</span>
          <span class="metric-value" id="scan-summary-symbols">–</span>
        </div>
      </div>
    </div>

    <div class="metric-group">
      <div class="metric-group-header">
        <h3>Breakout Candidates</h3>
      </div>
      <div class="table-scroll">
        <table id="scan-table">
          <thead>
            <tr>
              <th>Symbol</th>
              <th>Close</th>
              <th>Monthly $ Volume</th>
              <th>RS Percentile</th>
              <th>Flag/VCP Pass</th>
              <th>Weekly Contraction</th>
              <th>Monthly Contraction</th>
              <th>Minervini Criteria</th>
              <th>Qullamagie Score</th>
              <th>Qullamagie Criteria</th>
            </tr>
          </thead>
          <tbody id="scan-table-body"></tbody>
        </table>
      </div>
    </div>

    <div class="metric-group" id="scan-warnings-group" hidden>
      <div class="metric-group-header">
        <h3>Warnings</h3>
      </div>
      <ul id="scan-warnings" class="warning-list"></ul>
    </div>
  </section>
</section>
{% endblock %}
